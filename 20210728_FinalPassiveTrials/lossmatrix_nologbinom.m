function [ M ] = lossmatrix_nologbinom ( N,eps )
%Calculate transition matrix for Poisson loss with probability eps, out of
%a maximum marble number N. Each column is the probability distribution for a
%given current value of n

if 1
lf = [0
0
0.6931460803
1.791759435
3.178053828
4.787491742
6.579251212
8.525161361
10.6046029
12.80182748
15.10441257
17.50230785
19.9872145
22.55216385
25.19122118
27.89927138
30.67186011
33.50507345
36.39544521
39.33988419
42.33561646
45.3801389
48.47118135
51.60667557
54.7847294
58.00360522
61.26170176
64.55753863
67.88974314
71.25703897
74.65823635
78.09222355
81.55795946
85.05446702
88.58082754
92.1361756
95.71969454
99.33061245
102.9681986
106.6317603
110.3206397
114.0342118
117.7718814
121.5330815
125.3172711
129.1239336
132.952575
136.8027226
140.6739236
144.5657439
148.477767
152.4095926
156.3608363
160.3311282
164.3201123
168.3274454
172.3527971
176.3958484
180.4562914
184.5338289
188.6281734
192.7390473
196.8661817
201.0093164
205.1681995
209.3425868
213.5322415
217.7369341
221.9564418
226.1905483
230.4390436
234.7017234
238.9783896
243.268849
247.5729141
251.8904022
256.2211356
260.564941
264.9216498
269.2910977
273.6731243
278.0675734
282.4742927
286.8931333
291.3239501
295.7666014
300.2209486
304.6868568
309.1641936
313.6528299
318.1526396
322.6634991
327.1852877
331.7178872
336.261182
340.8150589
345.3794071
349.954118
354.5390855
359.1342054
363.7393756
368.3544961
372.9794689
377.6141979
382.2585888
386.9125491
391.5759882
396.2488171
400.9309483
405.6222962
410.3227765
415.0323067
419.7508056
424.4781934
429.2143919
433.959324
438.7129142
443.4750881
448.2457727
453.0248962
457.812388
462.6081785
467.4121996
472.2243839
477.0446655
481.8729792
486.7092611
491.5534482
496.4054785
501.2652909
506.1328253
511.0080227
515.8908246
520.7811737
525.6790135
530.5842883
535.4969432
540.4169241
545.3441778
550.2786517
555.2202941
560.169054
565.1248811
570.0877257
575.057539
580.0342728
585.0178794
590.008312
595.0055242
600.0094706
605.0201058
610.0373857
615.0612662
620.0917041
625.1286567
630.1720818
635.2219379
640.2781837
645.3407787
650.4096829
655.4848567
660.5662611
665.6538574
670.7476076
675.847474
680.9534195
686.0654073
691.1834011
696.3073651
701.4372638
706.5730622
711.7147258
716.8622203
722.0155119
727.1745672
732.3393531
737.5098371
742.6859869
747.8677704
753.0551562
758.2481131
763.4466101
768.6506168
773.860103
779.0750387
784.2953945
789.5211412
794.7522498
799.9886918
805.2304388
810.4774629
815.7297363
820.9872317
826.2499219
831.51778
836.7907796
842.0688942
847.352098
852.640365
857.9336698
863.2319872
868.5352921
873.8435598
879.1567658
884.4748858
889.7978957
895.1257719
900.4584907
905.7960288
911.138363
916.4854706
921.8373287
927.193915
932.5552071
937.9211832
943.2918212
948.6670996
954.046997
959.431492
964.8205637
970.2141913
975.612354
981.0150314
986.4222031
991.8338492
997.2499496
1002.670485
1008.095435
1013.52478
1018.958502
1024.396582
1029.838999
1035.285737
1040.736775
1046.192096
1051.651682
1057.115514
1062.583574
1068.055844
1073.532308
1079.012947
1084.497744
1089.986681
1095.479743
1100.976911
1106.478169
1111.983501
1117.492889
1123.006318
1128.523771
1134.045232
1139.570685
1145.100114
1150.633503
1156.170838
1161.712101
1167.257279
1172.806355
1178.359314
1183.916142
1189.476824
1195.041344
1200.609689
1206.181843
1211.757792
1217.337522
1222.921018
1228.508267
1234.099254
1239.693965
1245.292387
1250.894506
1256.500308
1262.10978
1267.722908
1273.339679
1278.96008
1284.584097
1290.211718
1295.84293
1301.47772
1307.116075
1312.757982
1318.403428
1324.052403
1329.704892
1335.360884
1341.020366
1346.683326
1352.349753
1358.019634
1363.692957
1369.369711
1375.049884
1380.733463
1386.420439
1392.110798
1397.80453
1403.501624
1409.202067
1414.90585
1420.61296
1426.323387
1432.03712
1437.754148
1443.47446
1449.198045
1454.924892
1460.654992
1466.388333
1472.124906
1477.864699
1483.607702
1489.353905
1495.103298
1500.855871
1506.611613
1512.370515
1518.132566
1523.897757
1529.666078
1535.437519
1541.212071
1546.989723
1552.770467
1558.554292
1564.341189
1570.131149
1575.924163
1581.720221
1587.519313
1593.321432
1599.126567
1604.934709
1610.74585
1616.559981
1622.377092
1628.197175
1634.020221
1639.846221
1645.675166
1651.507049
1657.34186
1663.17959
1669.020232
1674.863776
1680.710215
1686.55954
1692.411742
1698.266814
1704.124747
1709.985533
1715.849165
1721.715633
1727.58493
1733.457047
1739.331978
1745.209714
1751.090247
1756.973569
1762.859673
1768.748551
1774.640196
1780.534598
1786.431752
1792.33165
1798.234283
1804.139645
1810.047728
1815.958524
1821.872027
1827.788229
1833.707123
1839.628702
1845.552957
1851.479884
1857.409473
1863.341718
1869.276612
1875.214148
1881.154319
1887.097119
1893.042539
1898.990574
1904.941217
1910.89446
1916.850298
1922.808722
1928.769728
1934.733307
1940.699454
1946.668161
1952.639423
1958.613233
1964.589584
1970.56847
1976.549884
1982.53382
1988.520272
1994.509233
2000.500698
2006.494659
2012.491111
2018.490048
2024.491463
2030.49535
2036.501703
2042.510516
2048.521784
2054.535499
2060.551656
2066.570249
2072.591272
2078.61472
2084.640586
2090.668864
2096.69955
2102.732636
2108.768117
2114.805988
2120.846243
2126.888876
2132.933881
2138.981253
2145.030987
2151.083076
2157.137515
2163.194299
2169.253423
2175.314879
2181.378665
2187.444773
2193.513198
2199.583936
2205.656981
2211.732327
2217.809969
2223.889902
2229.972121
2236.05662
2242.143395
2248.23244
2254.32375
2260.41732
2266.513144
2272.611219
2278.711537
2284.814096
2290.918889
2297.025912
2303.13516
2309.246627
2315.360309
2321.476201
2327.594299
2333.714596
2339.837089
2345.961772
2352.088641
2358.217692
2364.348918
2370.482316
2376.617881
2382.755608
2388.895493
2395.03753
2401.181716
2407.328045
2413.476513
2419.627116
2425.779849
2431.934707
2438.091686
2444.250781
2450.411988
2456.575303
2462.740721
2468.908238
2475.077848
2481.249549
2487.423335
2493.599202
2499.777146
2505.957163
2512.139248
2518.323397
2524.509606
2530.69787
2536.888185
2543.080548
2549.274953
2555.471397
2561.669876
2567.870385
2574.07292
2580.277478
2586.484054
2592.692644
2598.903244
2605.11585
2611.330458
2617.547065
2623.765665
2629.986255
2636.208831
2642.43339
2648.659926
2654.888437
2661.118919
2667.351367
2673.585777
2679.822147
2686.060472
2692.300747
2698.542971
2704.787138
2711.033244
2717.281287
2723.531263
2729.783166
2736.036995
2742.292745
2748.550413
2754.809994
2761.071486
2767.334884
2773.600185
2779.867386
2786.136482
2792.407471
2798.680348
2804.95511
2811.231753
2817.510275
2823.790671
2830.072937
2836.357071
2842.64307
2848.930928
2855.220644
2861.512213
2867.805632
2874.100898
2880.398007
2886.696957
2892.997742
2899.300361
2905.60481
2911.911085
2918.219184
2924.529102
2930.840837
2937.154385
2943.469743
2949.786908
2956.105876
2962.426644
2968.749209
2975.073568
2981.399718
2987.727655
2994.057376
3000.388877
3006.722157
3013.057211
3019.394037
3025.732631
3032.07299
3038.415112
3044.758992
3051.104629
3057.452018
3063.801157
3070.152043
3076.504672
3082.859042
3089.21515
3095.572992
3101.932566
3108.293868
3114.656896
3121.021647
3127.388118
3133.756305
3140.126206
3146.497818
3152.871137
3159.246162
3165.622889
3172.001315
3178.381438
3184.763254
3191.14676
3197.531955
3203.918834
3210.307396
3216.697636
3223.089553
3229.483144
3235.878406
3242.275335
3248.67393
3255.074188
3261.476105
3267.879679
3274.284908
3280.691788
3287.100316
3293.510491
3299.92231
3306.335768
3312.750865
3319.167598
3325.585963
3332.005958
3338.42758
3344.850827
3351.275696
3357.702184
3364.13029
3370.560009
3376.99134
3383.42428
3389.858827
3396.294977
3402.732729
3409.172079
3415.613026
3422.055566
3428.499697
3434.945417
3441.392723
3447.841612
3454.292083
3460.744132
3467.197757
3473.652955
3480.109725
3486.568063
3493.027968
3499.489436
3505.952465
3512.417053
3518.883198
3525.350897
3531.820147
3538.290947
3544.763293
3551.237184
3557.712616
3564.189589
3570.668098
3577.148143
3583.62972
3590.112827
3596.597463
3603.083624
3609.571308
3616.060512
3622.551236
3629.043476
3635.53723
3642.032495
3648.52927
3655.027552
3661.527339
3668.028629
3674.531419
3681.035707
3687.541491
3694.048769
3700.557538
3707.067797
3713.579542
3720.092772
3726.607485
3733.123678
3739.641349
3746.160496
3752.681117
3759.20321
3765.726773
3772.251802
3778.778297
3785.306255
3791.835674
3798.366551
3804.898886
3811.432675
3817.967916
3824.504607
3831.042747
3837.582333
3844.123363
3850.665835
3857.209747
3863.755097
3870.301882
3876.850101
3883.399752
3889.950832
3896.50334
3903.057274
3909.61263
3916.169409
3922.727607
3929.287222
3935.848253
3942.410697
3948.974552
3955.539817
3962.10649
3968.674567
3975.244049
3981.814932
3988.387214
3994.960895
4001.53597
4008.11244
4014.690301
4021.269553
4027.850192
4034.432217
4041.015626
4047.600417
4054.186589
4060.774139
4067.363066
4073.953367
4080.54504
4087.138085
4093.732498
4100.328279
4106.925425
4113.523934
4120.123804
4126.725034
4133.327622
4139.931566
4146.536864
4153.143514
4159.751515
4166.360864
4172.97156
4179.583601
4186.196985
4192.811711
4199.427776
4206.045179
4212.663918
4219.283991
4225.905397
4232.528133
4239.152198
4245.777591
4252.404308
4259.03235
4265.661713
4272.292396
4278.924398
4285.557717
4292.19235
4298.828297
4305.465555
4312.104122
4318.743998
4325.38518
4332.027667
4338.671457
4345.316548
4351.962938
4358.610627
4365.259611
4371.90989
4378.561462
4385.214325
4391.868478
4398.523918
4405.180645
4411.838656
4418.49795
4425.158525
4431.82038
4438.483512
4445.147921
4451.813605
4458.480562
4465.14879
4471.818288
4478.489054
4485.161087
4491.834385
4498.508947
4505.18477
4511.861853
4518.540196
4525.219795
4531.900649
4538.582758
4545.266119
4551.950731
4558.636592
4565.3237
4572.012055
4578.701654
4585.392497
4592.08458
4598.777904
4605.472466
4612.168265
4618.865299
4625.563567
4632.263068
4638.963799
4645.665759
4652.368947
4659.073361
4665.779001
4672.485863
4679.193947
4685.903251
4692.613774
4699.325515
4706.038471
4712.752642
4719.468025
4726.18462
4732.902424
4739.621438
4746.341658
4753.063083
4759.785713
4766.509546
4773.234579
4779.960813
4786.688244
4793.416873
4800.146697
4806.877715
4813.609926
4820.343328
4827.077919
4833.8137
4840.550666
4847.288819
4854.028156
4860.768675
4867.510376
4874.253256
4880.997315
4887.742552
4894.488964
4901.23655
4907.98531
4914.735241
4921.486343
4928.238613
4934.992051
4941.746655
4948.502424
4955.259356
4962.017451
4968.776706
4975.537121
4982.298694
4989.061423
4995.825308
5002.590347
5009.356539
5016.123882
5022.892375
5029.662017
5036.432806
5043.204742
5049.977822
5056.752046
5063.527412
5070.303919
5077.081566
5083.860351
5090.640273
5097.42133
5104.203522
5110.986848
5117.771305
5124.556892
5131.343609
5138.131454
5144.920426
5151.710523
5158.501745
5165.294089
5172.087555
5178.882142
5185.677848
5192.474671
5199.272612
5206.071668
5212.871838
5219.673121
5226.475515
5233.279021
5240.083635
5246.889358
5253.696187
5260.504122
5267.313161
5274.123304
5280.934548
5287.746893
5294.560338
5301.374881
5308.190521
5315.007257
5321.825087
5328.644011
5335.464028
5342.285135
5349.107333
5355.930619
5362.754992
5369.580452
5376.406998
5383.234627
5390.063339
5396.893133
5403.724007
5410.55596
5417.388992
5424.223101
5431.058286
5437.894545
5444.731878
5451.570283
5458.409759
5465.250306
5472.091921
5478.934605
5485.778355
5492.62317
5499.46905
5506.315993
5513.163998
5520.013065
5526.863191
5533.714376
5540.566618
5547.419917
5554.274272
5561.129681
5567.986143
5574.843657
5581.702222
5588.561837
5595.4225
5602.284212
5609.14697
5616.010773
5622.875621
5629.741512
5636.608445
5643.476419
5650.345434
5657.215487
5664.086579
5670.958707
5677.831871
5684.706069
5691.581301
5698.457566
5705.334862
5712.213188
5719.092544
5725.972928
5732.854339
5739.736777
5746.62024
5753.504726
5760.390236
5767.276768
5774.16432
5781.052893
5787.942484
5794.833093
5801.724719
5808.617361
5815.511017
5822.405687
5829.30137
5836.198064
5843.095769
5849.994483
5856.894207
5863.794937
5870.696674
5877.599417
5884.503164
5891.407915
5898.313668
5905.220423
5912.128178
5919.036933
5925.946687
5932.857437
5939.769185
5946.681927
5953.595665
5960.510396
5967.426119
5974.342834
5981.26054
5988.179235
5995.098919
6002.01959
6008.941249
6015.863892
6022.787521
6029.712133
6036.637729
6043.564306
6050.491864
6057.420401
6064.349918
6071.280413
6078.211885
6085.144333
6092.077756
6099.012153
6105.947523
6112.883866
6119.82118
6126.759465
6133.698719
6140.638941
6147.580131
6154.522288
6161.46541
6168.409497
6175.354548
6182.300562
6189.247538
6196.195476
6203.144373
6210.094229
6217.045044
6223.996816
6230.949545
6237.903229
6244.857868
6251.81346
6258.770006
6265.727503
6272.685952
6279.64535
6286.605698
6293.566994
6300.529237
6307.492427
6314.456563
6321.421643
6328.387668
6335.354635
6342.322544
6349.291394
6356.261185
6363.231915
6370.203584
6377.17619
6384.149733
6391.124212
6398.099626
6405.075974
6412.053255
6419.031469
6426.010614
6432.99069
6439.971696
6446.953631
6453.936493
6460.920283
6467.905
6474.890641
6481.877208
6488.864698
6495.853111
6502.842447
6509.832703
6516.82388
6523.815976
6530.808991
6537.802924
6544.797774
6551.793541
6558.790222
6565.787818
6572.786328
6579.78575
6586.786085
6593.78733
6600.789486
6607.792552
6614.796526
6621.801408
6628.807197
6635.813892
6642.821493
6649.829998
6656.839407
6663.849719
6670.860933
6677.873048
6684.886064
6691.899979
6698.914794
6705.930506
6712.947116
6719.964622
6726.983024
6734.00232
6741.022511
6748.043595
6755.065571
6762.088439
6769.112198
6776.136847
6783.162386
6790.188813
6797.216127
6804.244328
6811.273416
6818.303389
6825.334246
6832.365988
6839.398612
6846.432118
6853.466506
6860.501775
6867.537923
6874.574951
6881.612857
6888.651641
6895.691301
6902.731837
6909.773249
6916.815535
6923.858695
6930.902728
6937.947633
6944.99341
6952.040057
6959.087574
6966.135961
6973.185215
6980.235338
6987.286327
6994.338183
7001.390904
7008.44449
7015.498939
7022.554252
7029.610428
7036.667465
7043.725362
7050.784121
7057.843738
7064.904215
7071.965549
7079.027741
7086.090789
7093.154693
7100.219452
7107.285065
7114.351532
7121.418852
7128.487024
7135.556047
7142.625922
7149.696646
7156.768219
7163.840641
7170.913911
7177.988027
7185.062991
7192.138799
7199.215453
7206.292951
7213.371293
7220.450477
7227.530504
7234.611372
7241.69308
7248.775629
7255.859017
7262.943243
7270.028307
7277.114209
7284.200947
7291.288521
7298.376929
7305.466172
7312.556249
7319.647159
7326.738901
7333.831475
7340.92488
7348.019114
7355.114179
7362.210072
7369.306793
7376.404342
7383.502718
7390.60192
7397.701947
7404.802799
7411.904475
7419.006974
7426.110296
7433.21444
7440.319406
7447.425192
7454.531798
7461.639223
7468.747468
7475.85653
7482.966409
7490.077105
7497.188617
7504.300945
7511.414087
7518.528043
7525.642812
7532.758395
7539.874789
7546.991994
7554.11001
7561.228837
7568.348472
7575.468917
7582.590169
7589.712229
7596.835096
7603.958769
7611.083247
7618.20853
7625.334617
7632.461508
7639.589202
7646.717698
7653.846995
7660.977094
7668.107992
7675.239691
7682.372189
7689.505485
7696.639578
7703.774469
7710.910156
7718.04664
7725.183918
7732.321991
7739.460858
7746.600518
7753.740971
7760.882217
7768.024253
7775.167081
7782.310698
7789.455105
7796.600301
7803.746286
7810.893058
7818.040617
7825.188963
7832.338095
7839.488012
7846.638713
7853.790199
7860.942467
7868.095519
7875.249353
7882.403968
7889.559364
7896.715541
7903.872497
7911.030233
7918.188747
7925.348039
7932.508108
7939.668954
7946.830576
7953.992973
7961.156146
7968.320093
7975.484813
7982.650306
7989.816572
7996.98361
8004.151419
8011.319999
8018.489349
8025.659469
8032.830357
8040.002014
8047.174439
8054.347631
8061.521589
8068.696313
8075.871803
8083.048057
8090.225076
8097.402859
8104.581404
8111.760712
8118.940782
8126.121613
8133.303205
8140.485557
8147.668669
8154.85254
8162.037169
8169.222556
8176.4087
8183.595601
8190.783258
8197.971671
8205.160839
8212.350761
8219.541437
8226.732866
8233.925048
8241.117983
8248.311668
8255.506105
8262.701293
8269.89723
8277.093916
8284.291352
8291.489535
8298.688466
8305.888145
8313.08857
8320.289741
8327.491657
8334.694318
8341.897724
8349.101873
8356.306765
8363.512401
8370.718778
8377.925897
8385.133757
8392.342357
8399.551697
8406.761777
8413.972595
8421.184152
8428.396447
8435.609478
8442.823246
8450.037751
8457.252991
8464.468966
8471.685675
8478.903119
8486.121296
8493.340205
8500.559847
8507.780221
8515.001326
8522.223162
8529.445728
8536.669024
8543.893049
8551.117802
8558.343284
8565.569493
8572.796429
8580.024091
8587.25248
8594.481593
8601.711432
8608.941995
8616.173282
8623.405293
8630.638026
8637.871481
8645.105658
8652.340557
8659.576176
8666.812515
8674.049574
8681.287353
8688.525849
8695.765064
8703.004997
8710.245647
8717.487013
8724.729095
8731.971893
8739.215406
8746.459634
8753.704575
8760.95023
8768.196598
8775.443679
8782.691472
8789.939976
8797.189191
8804.439116
8811.689752
8818.941097
8826.193151
8833.445913
8840.699383
8847.953561
8855.208446
8862.464037
8869.720335
8876.977337
8884.235045
8891.493457
8898.752573
8906.012393
8913.272915
8920.534141
8927.796068
8935.058696
8942.322026
8949.586056
8956.850786
8964.116216
8971.382345
8978.649172
8985.916697
8993.18492
9000.453841
9007.723457
9014.99377
9022.264779
9029.536483
9036.808881
9044.081973
9051.35576
9058.630239
9065.905412
9073.181276
9080.457833
9087.73508
9095.013019
9102.291648
9109.570967
9116.850975
9124.131672
9131.413058
9138.695132
9145.977893
9153.261341
9160.545476
9167.830297
9175.115803
9182.401995
9189.688871
9196.976432
9204.264676
9211.553604
9218.843215
9226.133507
9233.424482
9240.716138
9248.008476
9255.301493
9262.595191
9269.889568
9277.184625
9284.48036
9291.776773
9299.073864
9306.371632
9313.670077
9320.969199
9328.268996
9335.569469
9342.870617
9350.172439
9357.474936
9364.778106
9372.081949
9379.386465
9386.691653
9393.997513
9401.304045
9408.611247
9415.91912
9423.227662
9430.536875
9437.846756
9445.157306
9452.468525
9459.780411
9467.092965
9474.406185
9481.720072
9489.034625
9496.349843
9503.665726
9510.982275
9518.299487
9525.617363
9532.935903
9540.255105
9547.57497
9554.895497
9562.216686
9569.538535
9576.861046
9584.184217
9591.508047
9598.832537
9606.157686
9613.483494
9620.809959
9628.137082
9635.464863
9642.7933
9650.122394
9657.452144
9664.782549
9672.113609
9679.445324
9686.777694
9694.110717
9701.444393
9708.778722
9716.113704
9723.449338
9730.785624
9738.122561
9745.460148
9752.798387
9760.137275
9767.476812
9774.816999
9782.157835
9789.499319
9796.84145
9804.18423
9811.527656
9818.871729
9826.216448
9833.561813
9840.907823
9848.254478
9855.601778
9862.949721
9870.298309
9877.64754
9884.997414
9892.34793
9899.699088
9907.050888
9914.403329
9921.756411
9929.110133
9936.464495
9943.819497
9951.175138
9958.531418
9965.888337
9973.245893
9980.604087
9987.962917
9995.322385
10002.68249
10010.04323
10017.4046
10024.76661
10032.12926
10039.49254
10046.85645
10054.221
10061.58618
10068.95199
10076.31844
10083.68552
10091.05322
10098.42156
10105.79053
10113.16013
10120.53037
10127.90123
10135.27271
10142.64483
10150.01758
10157.39095
10164.76496
10172.13958
10179.51484
10186.89072
10194.26723
10201.64436
10209.02212
10216.40051
10223.77952
10231.15915
10238.5394
10245.92028
10253.30178
10260.68391
10268.06665
10275.45002
10282.83401
10290.21862
10297.60385
10304.9897
10312.37618
10319.76327
10327.15098
10334.5393
10341.92825
10349.31781
10356.70799
10364.09879
10371.49021
10378.88224
10386.27489
10393.66815
10401.06203
10408.45652
10415.85163
10423.24735
10430.64369
10438.04063
10445.4382
10452.83637
10460.23516
10467.63455
10475.03456
10482.43518
10489.83642
10497.23826
10504.64071
10512.04377
10519.44744
10526.85172
10534.25661
10541.6621
10549.06821
10556.47492
10563.88223
10571.29016
10578.69869
10586.10783
10593.51757
10600.92792
10608.33887
10615.75042
10623.16258
10630.57535
10637.98872
10645.40269
10652.81726
10660.23243
10667.64821
10675.06459
10682.48157
10689.89915
10697.31733
10704.73611
10712.15549
10719.57547
10726.99605
10734.41723
10741.839
10749.26138
10756.68435
10764.10792
10771.53208
10778.95684
10786.3822
10793.80816
10801.2347
10808.66185
10816.08959
10823.51792
10830.94685
10838.37637
10845.80648
10853.23719
10860.66849
10868.10038
10875.53287
10882.96594
10890.39961
10897.83386
10905.26871
10912.70415
10920.14018
10927.5768
10935.014
10942.4518
10949.89018
10957.32915
10964.76871
10972.20886
10979.64959
10987.09091
10994.53282
11001.97531
11009.41839
11016.86205
11024.3063
11031.75114
11039.19655
11046.64255
11054.08914
11061.53631
11068.98406
11076.43239
11083.88131
11091.33081
11098.78089
11106.23155
11113.68279
11121.13461
11128.58701
11136.04
11143.49356
11150.9477
11158.40242
11165.85772
11173.31359
11180.77005
11188.22708
11195.68469
11203.14288
11210.60164
11218.06098
11225.52089
11232.98138
11240.44245
11247.90409
11255.3663
11262.82909
11270.29246
11277.75639
11285.2209
11292.68599
11300.15164
11307.61787
11315.08467
11322.55204
11330.01998
11337.48849
11344.95758
11352.42723
11359.89746
11367.36825
11374.83961
11382.31155
11389.78405
11397.25712
11404.73075
11412.20496
11419.67973
11427.15507
11434.63097
11442.10745
11449.58449
11457.06209
11464.54026
11472.01899
11479.49829
11486.97816
11494.45859
11501.93958
11509.42113
11516.90325
11524.38593
11531.86918
11539.35299
11546.83735
11554.32229
11561.80778
11569.29383
11576.78044
11584.26762
11591.75535
11599.24364
11606.7325
11614.22191
11621.71188
11629.20241
11636.6935
11644.18514
11651.67734
11659.17011
11666.66342
11674.1573
11681.65173
11689.14671
11696.64225
11704.13835
11711.635
11719.13221
11726.62997
11734.12829
11741.62716
11749.12658
11756.62656
11764.12709
11771.62817
11779.12981
11786.63199
11794.13473
11801.63802
11809.14186
11816.64625
11824.15119
11831.65669
11839.16273
11846.66932
11854.17646
11861.68415
11869.19239
11876.70118
11884.21051
11891.7204
11899.23083
11906.7418
11914.25333
11921.7654
11929.27802
11936.79118
11944.30489
11951.81914
11959.33394
11966.84929
11974.36518
11981.88161
11989.39859
11996.91611
12004.43417
12011.95278
12019.47193
12026.99162
12034.51186
12042.03263
12049.55395
12057.07581
12064.59821
12072.12115
12079.64463
12087.16866
12094.69322
12102.21832
12109.74396
12117.27014
12124.79685
12132.32411
12139.8519
12147.38024
12154.9091
12162.43851
12169.96845
12177.49893
12185.02995
12192.5615
12200.09359
12207.62621
12215.15937
12222.69307
12230.2273
12237.76206
12245.29736
12252.83319
12260.36955
12267.90645
12275.44388
12282.98184
12290.52033
12298.05936
12305.59892
12313.13901
12320.67963
12328.22078
12335.76247
12343.30468
12350.84742
12358.3907
12365.9345
12373.47883
12381.02369
12388.56908
12396.115
12403.66145
12411.20842
12418.75592
12426.30395
12433.85251
12441.40159
12448.9512
12456.50134
12464.052
12471.60318
12479.1549
12486.70713
12494.2599
12501.81318
12509.36699
12516.92133
12524.47619
12532.03157
12539.58747
12547.1439
12554.70085
12562.25833
12569.81632
12577.37484
12584.93388
12592.49343
12600.05352
12607.61412
12615.17524
12622.73688
12630.29904
12637.86172
12645.42492
12652.98864
12660.55288
12668.11764
12675.68291
12683.24871
12690.81502
12698.38185
12705.94919
12713.51705
12721.08543
12728.65433
12736.22374
12743.79367
12751.36411
12758.93507
12766.50654
12774.07853
12781.65104
12789.22405
12796.79758
12804.37163
12811.94619
12819.52126
12827.09684
12834.67294
12842.24955
12849.82667
12857.40431
12864.98245
12872.56111
12880.14028
12887.71996
12895.30015
12902.88085
12910.46206
12918.04377
12925.626
12933.20874
12940.79199
12948.37575
12955.96001
12963.54478
12971.13007
12978.71585
12986.30215
12993.88895
13001.47626
13009.06408
13016.65241
13024.24124
13031.83057
13039.42041
13047.01076
13054.60161
13062.19297
13069.78483
13077.3772
13084.97007
13092.56344
13100.15732
13107.7517
13115.34658
13122.94197
13130.53786
13138.13425
13145.73115
13153.32854
13160.92644
13168.52484
13176.12374
13183.72314
13191.32305
13198.92345
13206.52435
]';
end

M = zeros(N+1);
for k = 1:N+1
    for j = 1:N+1
       if (k<=j)
           loss = j-k; %Number of photons lost from the beam
           lb = lf(j-1+1) - lf(loss+1) - lf(j-1-loss+1);
           M(k,j) = exp(lb + loss*log(eps) + (j-1-loss) * log(1-eps)); %More accurate to calculate products of large numbers by summing their logs
       else
           M(k,j) = 0; %can never increase the photon number
       end
   end
end

end
